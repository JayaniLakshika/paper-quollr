<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space</title>

  <meta property="description" itemprop="description" content="Non-linear dimension reduction (NLDR) methods provide a low-dimensional representation of high-dimensional data (p\text{-}D) by applying a non-linear transformation. However, the complexity of the transformations and data structures can create wildly different representations depending on the method and (hyper)parameter choices. It is difficult to determine whether any of these representations are accurate, which one is the best, or whether they have missed important structures. The R package \CRANpkg{quollr} has been developed as a new visual tool to determine which method and which (hyper)parameter choices provide the most accurate representation of high-dimensional data. The `triangular_3d_data` data from the \CRANpkg{cardinalR} package is used to illustrate the algorithm and its application within the package."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-04-08"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-04-08"/>
  <meta name="article:author" content="Jayani P.G. Lakshika"/>
  <meta name="article:author" content="Dianne Cook"/>
  <meta name="article:author" content="Paul Harrison"/>
  <meta name="article:author" content="Michael Lydeamore"/>
  <meta name="article:author" content="Thiyanga S. Talagala"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Non-linear dimension reduction (NLDR) methods provide a low-dimensional representation of high-dimensional data (p\text{-}D) by applying a non-linear transformation. However, the complexity of the transformations and data structures can create wildly different representations depending on the method and (hyper)parameter choices. It is difficult to determine whether any of these representations are accurate, which one is the best, or whether they have missed important structures. The R package \CRANpkg{quollr} has been developed as a new visual tool to determine which method and which (hyper)parameter choices provide the most accurate representation of high-dimensional data. The `triangular_3d_data` data from the \CRANpkg{cardinalR} package is used to illustrate the algorithm and its application within the package."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space"/>
  <meta property="twitter:description" content="Non-linear dimension reduction (NLDR) methods provide a low-dimensional representation of high-dimensional data (p\text{-}D) by applying a non-linear transformation. However, the complexity of the transformations and data structures can create wildly different representations depending on the method and (hyper)parameter choices. It is difficult to determine whether any of these representations are accurate, which one is the best, or whether they have missed important structures. The R package \CRANpkg{quollr} has been developed as a new visual tool to determine which method and which (hyper)parameter choices provide the most accurate representation of high-dimensional data. The `triangular_3d_data` data from the \CRANpkg{cardinalR} package is used to illustrate the algorithm and its application within the package."/>

  <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
  <meta name="citation_title" content="quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space"/>
  <meta name="citation_pdf_url" content="paper-quollr.pdf"/>
  <meta name="citation_journal_title" content="The R Journal"/>
  <meta name="citation_issn" content="2073-4859"/>
  <meta name="citation_firstpage" content="1"/>
  <meta name="citation_fulltext_world_readable" content=""/>
  <meta name="citation_online_date" content="2025/04/08"/>
  <meta name="citation_publication_date" content="2025/04/08"/>
  <meta name="citation_author" content="Jayani P.G. Lakshika"/>
  <meta name="citation_author_institution" content="Monash University"/>
  <meta name="citation_author" content="Dianne Cook"/>
  <meta name="citation_author_institution" content="Monash University"/>
  <meta name="citation_author" content="Paul Harrison"/>
  <meta name="citation_author_institution" content="Monash University"/>
  <meta name="citation_author" content="Michael Lydeamore"/>
  <meta name="citation_author_institution" content="Monash University"/>
  <meta name="citation_author" content="Thiyanga S. Talagala"/>
  <meta name="citation_author_institution" content="University of Sri Jayewardenepura"/>
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=R markdown: The definitive guide;citation_publisher=Chapman; Hall/CRC;citation_author=Yihui Xie;citation_author=J. J. Allaire;citation_author=Garrett Grolemund"/>
  <meta name="citation_reference" content="citation_title=Dynamic documents with R and knitr;citation_publisher=Chapman; Hall/CRC;citation_author=Yihui Xie"/>
  <meta name="citation_reference" content="citation_title=Hexbin: Hexagonal binning routines;citation_author=Dan Carr;citation_author= Nicholas Lewin-Koh;citation_author=Martin Maechler;citation_author= Deepayan Sarkar"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","draft","author","type","creative_commons","date","preamble","output","bibliography","editor_options","journal","slug","pdf_url","packages","CTV","csl"]}},"value":[{"type":"character","attributes":{},"value":["quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space"]},{"type":"character","attributes":{},"value":["Non-linear dimension reduction (NLDR) methods provide a low-dimensional representation of high-dimensional data (p\\text{-}D) by applying a non-linear transformation. However, the complexity of the transformations and data structures can create wildly different representations depending on the method and (hyper)parameter choices. It is difficult to determine whether any of these representations are accurate, which one is the best, or whether they have missed important structures. The R package \\CRANpkg{quollr} has been developed as a new visual tool to determine which method and which (hyper)parameter choices provide the most accurate representation of high-dimensional data. The `triangular_3d_data` data from the \\CRANpkg{cardinalR} package is used to illustrate the algorithm and its application within the package.\n"]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","orcid_id","email"]}},"value":[{"type":"character","attributes":{},"value":["Jayani P.G. Lakshika"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Department of Econometrics and Business Statistics, VIC 3800 Australia"]},{"type":"character","attributes":{},"value":["https://jayanilakshika.netlify.app/"]},{"type":"character","attributes":{},"value":["0000-0002-6265-6481"]},{"type":"character","attributes":{},"value":["\\email{jayani.piyadigamage@monash.edu}"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Dianne Cook"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Department of Econometrics and Business Statistics, VIC 3800 Australia"]},{"type":"character","attributes":{},"value":["http://www.dicook.org/"]},{"type":"character","attributes":{},"value":["dicook@monash.edu"]},{"type":"character","attributes":{},"value":["0000-0002-3813-7155"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Paul Harrison"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["MGBP, BDInstitute, VIC 3800 Australia"]},{"type":"character","attributes":{},"value":["paul.harrison@monash.edu"]},{"type":"character","attributes":{},"value":["0000-0002-3980-268X"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Michael Lydeamore"]},{"type":"character","attributes":{},"value":["Monash University"]},{"type":"character","attributes":{},"value":["Department of Econometrics and Business Statistics, VIC 3800 Australia"]},{"type":"character","attributes":{},"value":["michael.lydeamore@monash.edu"]},{"type":"character","attributes":{},"value":["0000-0001-6515-827X"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","address","url","email","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Thiyanga S. Talagala"]},{"type":"character","attributes":{},"value":["University of Sri Jayewardenepura"]},{"type":"character","attributes":{},"value":["Department of Statistics, Gangodawila, Nugegoda 10100 Sri Lanka"]},{"type":"character","attributes":{},"value":["https://thiyanga.netlify.app/"]},{"type":"character","attributes":{},"value":["ttalagala@sjp.ac.lk"]},{"type":"character","attributes":{},"value":["0000-0002-0656-9789"]}]}]},{"type":"character","attributes":{},"value":["package"]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["2025-04-08"]},{"type":"character","attributes":{},"value":["\\usepackage{amsmath} \\usepackage{array}\n"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["css","keep_md"]}},"value":[{"type":"character","attributes":{},"value":["style.css"]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["RJreferences.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["inline"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","issn","firstpage","lastpage"]}},"value":[{"type":"character","attributes":{},"value":["The R Journal"]},{"type":"character","attributes":{},"value":["2073-4859"]},{"type":"double","attributes":{},"value":[1]},{"type":"NULL"}]},{"type":"character","attributes":{},"value":["paper-quollr"]},{"type":"character","attributes":{},"value":["paper-quollr.pdf"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["cran","bioc"]}},"value":[{"type":"character","attributes":{},"value":["quollr","cardinalR","testthat","knitr","rmarkdown"]},{"type":"list","attributes":{},"value":[]}]},{"type":"character","attributes":{},"value":["ReproducibleResearch"]},{"type":"character","attributes":{},"value":["/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjtools/rjournal.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/facs_Muscle_seurat_tiss.Robj","data/FACS.zip","data/flavia_dataset.csv","data/limb_muscles/annotations_FACS.csv","data/limb_muscles/error_limb_muscles_pacmap_n-neighbors_10_init_random_MN-ratio_0.5_FP-ratio_2.rds","data/limb_muscles/error_limb_muscles_phate_knn_5.rds","data/limb_muscles/error_limb_muscles_trimap_n-inliers_12_n-outliers_4_n-random_3.rds","data/limb_muscles/error_limb_muscles_trimap_n-inliers_30_n-outliers_4_n-random_3.rds","data/limb_muscles/error_limb_muscles_trimap_n-inliers_5_n-outliers_4_n-random_3.rds","data/limb_muscles/error_limb_muscles_tsne_perplexity_15.rds","data/limb_muscles/error_limb_muscles_tsne_perplexity_30.rds","data/limb_muscles/error_limb_muscles_umap_n-neigbors_15_min-dist_0.1.rds","data/limb_muscles/error_limb_muscles_umap_n-neigbors_30_min-dist_0.1.rds","data/limb_muscles/facs_limb_dist_df_with clusters.rds","data/limb_muscles/facs_limb_dist_df.rds","data/limb_muscles/facs_limb_muscles_cluster_df.rds","data/limb_muscles/facs_limb_muscles_pacmap_n-neighbors_10_init_random_MN-ratio_0.5_FP-ratio_2.rds","data/limb_muscles/facs_limb_muscles_pcs_10.rds","data/limb_muscles/facs_limb_muscles_phate_knn_5.rds","data/limb_muscles/facs_limb_muscles_trimap_n-inliers_12_n-outliers_4_n-random_3.rds","data/limb_muscles/facs_limb_muscles_trimap_n-inliers_30_n-outliers_4_n-random_3.rds","data/limb_muscles/facs_limb_muscles_trimap_n-inliers_5_n-outliers_4_n-random_3.rds","data/limb_muscles/facs_limb_muscles_tsne_perplexity_15.rds","data/limb_muscles/facs_limb_muscles_tsne_perplexity_30.rds","data/limb_muscles/facs_limb_muscles_umap_n-neigbors_15_min-dist_0.1.rds","data/limb_muscles/facs_limb_muscles_umap_n-neigbors_30_min-dist_0.1.rds","data/limb_muscles/Limb_Muscle-counts.csv","data/limb_muscles/metadata_FACS.csv","data/medlea_dataset.csv","data/star.rds","data/star.txt","figures/buffer_img.png","figures/hex_coordinates_img.png","figures/hex_size_img.png","figures/spacing_img.png","figures/workflow_all_centroids.png","figures/workflow_all_coordinates.png","initial_paper","motivation-letter/motivation-letter.md","paper_old_1.qmd","paper_old_2.qmd","paper-quollr_files/anchor-4.2.2/anchor.min.js","paper-quollr_files/bowser-1.9.3/bowser.min.js","paper-quollr_files/distill-2.2.21/template.v2.js","paper-quollr_files/figure-html5/fig-limb-mse-1.png","paper-quollr_files/figure-html5/fig-nldervis-1.png","paper-quollr_files/figure-html5/hex-bin-1.png","paper-quollr_files/figure-html5/mesh-diffplots-1.png","paper-quollr_files/figure-html5/mesh-plots-1.png","paper-quollr_files/figure-html5/tsne-clust-1.png","paper-quollr_files/figure-html5/unnamed-chunk-10-1.png","paper-quollr_files/figure-html5/unnamed-chunk-11-1.png","paper-quollr_files/figure-html5/unnamed-chunk-12-1.png","paper-quollr_files/figure-html5/unnamed-chunk-13-1.png","paper-quollr_files/figure-html5/unnamed-chunk-14-1.png","paper-quollr_files/figure-html5/unnamed-chunk-15-1.png","paper-quollr_files/figure-html5/unnamed-chunk-16-1.png","paper-quollr_files/figure-html5/unnamed-chunk-17-1.png","paper-quollr_files/figure-html5/unnamed-chunk-18-1.png","paper-quollr_files/figure-html5/unnamed-chunk-19-1.png","paper-quollr_files/figure-html5/unnamed-chunk-2-1.png","paper-quollr_files/figure-html5/unnamed-chunk-20-1.png","paper-quollr_files/figure-html5/unnamed-chunk-21-1.png","paper-quollr_files/figure-html5/unnamed-chunk-22-1.png","paper-quollr_files/figure-html5/unnamed-chunk-23-1.png","paper-quollr_files/figure-html5/unnamed-chunk-24-1.png","paper-quollr_files/figure-html5/unnamed-chunk-25-1.png","paper-quollr_files/figure-html5/unnamed-chunk-26-1.png","paper-quollr_files/figure-html5/unnamed-chunk-27-1.png","paper-quollr_files/figure-html5/unnamed-chunk-28-1.png","paper-quollr_files/figure-html5/unnamed-chunk-29-1.png","paper-quollr_files/figure-html5/unnamed-chunk-3-1.png","paper-quollr_files/figure-html5/unnamed-chunk-30-1.png","paper-quollr_files/figure-html5/unnamed-chunk-31-1.png","paper-quollr_files/figure-html5/unnamed-chunk-32-1.png","paper-quollr_files/figure-html5/unnamed-chunk-33-1.png","paper-quollr_files/figure-html5/unnamed-chunk-34-1.png","paper-quollr_files/figure-html5/unnamed-chunk-35-1.png","paper-quollr_files/figure-html5/unnamed-chunk-4-1.png","paper-quollr_files/figure-html5/unnamed-chunk-5-1.png","paper-quollr_files/figure-html5/unnamed-chunk-6-1.png","paper-quollr_files/figure-html5/unnamed-chunk-7-1.png","paper-quollr_files/figure-html5/unnamed-chunk-8-1.png","paper-quollr_files/figure-html5/unnamed-chunk-9-1.png","paper-quollr_files/header-attrs-2.26/header-attrs.js","paper-quollr_files/header-attrs-2.27/header-attrs.js","paper-quollr_files/header-attrs-2.29/header-attrs.js","paper-quollr_files/htmltools-fill-0.5.8.1/fill.css","paper-quollr_files/htmlwidgets-1.6.4/htmlwidgets.js","paper-quollr_files/jquery-3.6.0/jquery-3.6.0.js","paper-quollr_files/jquery-3.6.0/jquery-3.6.0.min.js","paper-quollr_files/jquery-3.6.0/jquery-3.6.0.min.map","paper-quollr_files/langevitour-0.7/langevitour-pack.js","paper-quollr_files/langevitour-binding-0.7/langevitour.js","paper-quollr_files/popper-2.6.0/popper.min.js","paper-quollr_files/tippy-6.2.7/tippy-bundle.umd.min.js","paper-quollr_files/tippy-6.2.7/tippy-light-border.css","paper-quollr_files/tippy-6.2.7/tippy.css","paper-quollr_files/tippy-6.2.7/tippy.umd.min.js","paper-quollr_files/webcomponents-2.0.0/webcomponents.js","paper-quollr.log","paper-quollr.tex","RJournal.sty","RJreferences.bib","RJwrapper.log","RJwrapper.tex","Rlogo-5.png","scripts/additional_functions.R","scripts/application.R","scripts/FACs/01_data_preprocessing.R","scripts/FACs/02_gen_embeddings.R","scripts/FACs/03_gen_mse_for_diff_methods.R","scripts/FACs/04_compute_distances.R","scripts/FACs/05_comb_clust_distances.R","scripts/FACs/06_comp_distances_clust_wise.R","style.css"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="paper-quollr_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="paper-quollr_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="paper-quollr_files/popper-2.6.0/popper.min.js"></script>
  <link href="paper-quollr_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="paper-quollr_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="paper-quollr_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="paper-quollr_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="paper-quollr_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="paper-quollr_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="paper-quollr_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->
  <script>
    $(function() {
      console.log("Starting...")

      // Mathjax config (add automatic linebreaks when supported)
      // MathJax = {
      //    tex: {
      //        inlineMath: [['$', '$'], ['\\(', '\\)']],
      //        displayMath: [['$$', '$$'], ['\\[', '\\]']],
      //        tags: 'ams',
      //        multline: true,
      //    },
      //    options: {
      //        linebreaks: { automatic: true },
      //    },
      // };

      // Always show Published - distill hides it if not set
      function show_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'visible');
      }

      show_byline_column('Published')

      // tweak function
      var rmd_meta = JSON.parse($("#radix-rmarkdown-metadata").html());
      function get_meta(name, meta) {
        var ind = meta.attributes.names.value.findIndex((e) => e == name)
        var val = meta.value[ind]
        if (val.type != 'list') {
          return val.value.toString()
        }
        return val
      }

      // tweak description
      // Add clickable tags
      const slug = get_meta('slug', rmd_meta)
      const cite_url = get_meta('citation_url', rmd_meta)

      var title = $("d-title").text

      const buttons = $('<div class="dt-tags" style="grid-column: page;">')
      buttons.append('<a href="#citation" class="dt-tag"><i class="fas fa-quote-left"></i> Cite</a>')
      buttons.append('<a href="' + slug + '.pdf" class="dt-tag"><i class="fas fa-file-pdf"></i> PDF</a>')
      buttons.append('<a href="' + slug + '.zip" class="dt-tag"><i class="fas fa-file-zipper"></i> Supplement</a>')

      // adds Abstract: in front of the first <p> in the title section --
      // unless it happens to be the subtitle (FIXME: this is a bad hack - can't distill do this?)
      var tpar = $("d-title p:not(:empty)").filter(function() {
        return !$(this).hasClass("subtitle");
      }).first();
      if (tpar) {
        const abstract = $('<d-abstract>')
        abstract.append('<b>Abstract:</b><br>')
        abstract.append(tpar) // Move description to d-abstract
        $("d-title p:empty").remove() // Remove empty paragraphs after title
        abstract.append(buttons)
        abstract.insertAfter($('d-title')) // Add abstract section after title */
      }

      // tweak by-line
      var byline = $("d-byline div.byline")
      ind = rmd_meta.attributes.names.value.findIndex((e) => e == "journal")
      const journal = get_meta('journal', rmd_meta)
      const volume = get_meta('volume', rmd_meta)
      const issue = get_meta('issue', rmd_meta)
      const jrtitle = get_meta('title', journal)
      const year = ((jrtitle == "R News") ? 2000 : 2008) + parseInt(volume)
      const firstpage = get_meta('firstpage', journal)
      const lastpage = get_meta('lastpage', journal)
      byline.append('<div class="rjournal grid">')
      $('div.rjournal').append('<h3>Volume</h3>')
      $('div.rjournal').append('<h3>Pages</h3>')
      $('div.rjournal').append('<a class="volume" href="../../issues/'+year+'-'+issue+'">'+volume+'/'+issue+'</a>')
      $('div.rjournal').append('<p class="pages">'+firstpage+' - '+lastpage+'</p>')

      const received_date = new Date(get_meta('date_received', rmd_meta))
      byline.find('h3:contains("Published")').parent().append('<h3>Received</h3><p>'+received_date.toLocaleDateString('en-US', {month: 'short'})+' '+received_date.getDate()+', '+received_date.getFullYear()+'</p>')

    })
  </script>

  <style>
      /*
    .nav-dropdown-content .nav-dropdown-header {
      text-transform: lowercase;
    }
    */

    d-byline .byline {
      grid-template-columns: 2fr 2fr 2fr 2fr;
    }

    d-byline .rjournal {
      grid-column-end: span 2;
      grid-template-columns: 1fr 1fr;
      margin-bottom: 0;
    }

    d-title h1, d-title p, d-title figure,
    d-abstract p, d-abstract b {
      grid-column: page;
    }

    d-title .dt-tags {
      grid-column: page;
    }

    .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    d-article h1 {
      line-height: 1.1em;
    }

    d-abstract p, d-article p {
      text-align: justify;
    }

    @media(min-width: 1000px) {
      .d-contents.d-contents-float {
        justify-self: end;
      }

      nav.toc {
        border-right: 1px solid rgba(0, 0, 0, 0.1);
        border-right-width: 1px;
        border-right-style: solid;
        border-right-color: rgba(0, 0, 0, 0.1);
      }
    }

    .posts-list .dt-tags .dt-tag {
      text-transform: lowercase;
    }

    @keyframes highlight-target {
      0% {
        background-color: #ffa;
      }
      66% {
        background-color: #ffa;
      }
      100% {
        background-color: none;
      }
    }

    d-article :target, d-appendix :target {
       animation: highlight-target 3s;
    }

    .header-section-number {
      margin-right: 0.5em;
    }
    
    d-appendix .citation-appendix,
    .d-appendix .citation-appendix {
      color: rgb(60, 60, 60);
    }

    d-article h2 {
      border-bottom: 0px solid rgba(0, 0, 0, 0.1);
      padding-bottom: 0rem;
    }
    d-article h3 {
      font-size: 20px;
    }
    d-article h4 {
      font-size: 18px;
      text-transform: none;
    }

    @media (min-width: 1024px) {
      d-article h2 {
        font-size: 32px;
      }
      d-article h3 {
        font-size: 24px;
      }
      d-article h4 {
        font-size: 20px;
      }
    }
  </style>

  <link rel="stylesheet" href="style.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space","description":"Non-linear dimension reduction (NLDR) methods provide a low-dimensional representation of high-dimensional data (p\\text{-}D) by applying a non-linear transformation. However, the complexity of the transformations and data structures can create wildly different representations depending on the method and (hyper)parameter choices. It is difficult to determine whether any of these representations are accurate, which one is the best, or whether they have missed important structures. The R package \\CRANpkg{quollr} has been developed as a new visual tool to determine which method and which (hyper)parameter choices provide the most accurate representation of high-dimensional data. The `triangular_3d_data` data from the \\CRANpkg{cardinalR} package is used to illustrate the algorithm and its application within the package.","authors":[{"author":"Jayani P.G. Lakshika","authorURL":"https://jayanilakshika.netlify.app/","affiliation":"Monash University","affiliationURL":"#","orcidID":"0000-0002-6265-6481"},{"author":"Dianne Cook","authorURL":"http://www.dicook.org/","affiliation":"Monash University","affiliationURL":"#","orcidID":"0000-0002-3813-7155"},{"author":"Paul Harrison","authorURL":"#","affiliation":"Monash University","affiliationURL":"#","orcidID":"0000-0002-3980-268X"},{"author":"Michael Lydeamore","authorURL":"#","affiliation":"Monash University","affiliationURL":"#","orcidID":"0000-0001-6515-827X"},{"author":"Thiyanga S. Talagala","authorURL":"https://thiyanga.netlify.app/","affiliation":"University of Sri Jayewardenepura","affiliationURL":"#","orcidID":"0000-0002-0656-9789"}],"publishedDate":"2025-04-08T00:00:00.000+10:00","citationText":"Lakshika, et al., 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>quollr: An R Package for Visualizing 2-D Models from Non-linear Dimension Reductions in High Dimensional Space</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Non-linear dimension reduction (NLDR) methods provide a low-dimensional representation of high-dimensional data (pD) by applying a non-linear transformation. However, the complexity of the transformations and data structures can create wildly different representations depending on the method and (hyper)parameter choices. It is difficult to determine whether any of these representations are accurate, which one is the best, or whether they have missed important structures. The R package <a href="https://cran.r-project.org/package=quollr">quollr</a> has been developed as a new visual tool to determine which method and which (hyper)parameter choices provide the most accurate representation of high-dimensional data. The <code>triangular_3d_data</code> data from the <a href="https://cran.r-project.org/package=cardinalR">cardinalR</a> package is used to illustrate the algorithm and its application within the package.</p></p>
</div>

<div class="d-byline">
  Jayani P.G. Lakshika <a href="https://jayanilakshika.netlify.app/" class="uri">https://jayanilakshika.netlify.app/</a> (Monash University)
  
,   Dianne Cook <a href="http://www.dicook.org/" class="uri">http://www.dicook.org/</a> (Monash University)
  
,   Paul Harrison  (Monash University)
  
,   Michael Lydeamore  (Monash University)
  
,   Thiyanga S. Talagala <a href="https://thiyanga.netlify.app/" class="uri">https://thiyanga.netlify.app/</a> (University of Sri Jayewardenepura)
  
<br/>2025-04-08
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<!-- 20 pages-->
<h2 data-number="1" id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<!-- research gap: add about hexbin pkg, and emphasize that in our package provide regular hexagons-->
<!-- objective: introduce a new tool to help to determine which method, which parameter choice provide the most useful representation of high-D data.-->
<!--intro with S-curve with 5 methods-->
<p>This paper presents the R package, <code>quollr</code> which introduce a new visual tool in determining which Non-linear dimension reduction (NLDR) technique and which (hyper)parameter choice gives most accurate representation of high-dimensional data. The methodology of the algorithm is explained in <em>cite the methodology paper</em>. Furthermore, the <code>quollr</code> package enables users to perform hexagonal binning <span class="citation" data-cites="dan2023">(<a href="#ref-dan2023" role="doc-biblioref">Carr et al. 2023</a>)</span>, resulting in the generation of regular hexagons. The software is available from the Comprehensive R Archive Network (CARN) at <a href="https://CRAN.R-project.org/package=quollr">https://CRAN.R-project.org/package=quollr</a>.</p>
<p>The paper is organized as follows. In next section, introduces the implementation of <code>quollr</code> package on CRAN, including demonstration of the packages key functions and visualization capabilities. We illustrate the algorithms functionality to study about clustering data structure in <strong>Application</strong> section, and describe a visual heuristic to describe parameter selection. Finally, we give a brief conclusion of the paper and discuss potential opportunities for use of our algorithm.</p>
<h2 data-number="2" id="implementation"><span class="header-section-number">2</span> Implementation</h2>
<p>The package can be installed from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;quollr&quot;</span>)</span></code></pre></div>
<p>The development version can be installed from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;JayaniLakshika/quollr&quot;</span>)</span></code></pre></div>
<h3 data-number="2.1" id="package-dependencies"><span class="header-section-number">2.1</span> Package dependencies</h3>
<p>Understanding the dependencies of the <code>quollr</code> package is essential for smooth operation and error prevention. The following dependencies refer to the other R packages that <code>quollr</code> relies on to execute its functions effectively.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$quollr
 [1] &quot;dplyr&quot;       &quot;ggplot2&quot;     &quot;grid&quot;        &quot;interp&quot;     
 [5] &quot;langevitour&quot; &quot;proxy&quot;       &quot;rlang&quot;       &quot;rsample&quot;    
 [9] &quot;stats&quot;       &quot;tibble&quot;      &quot;tidyselect&quot; </code></pre>
</div>
<h3 data-number="2.2" id="usage"><span class="header-section-number">2.2</span> Usage</h3>
<!-- add about main function to gen 2D and highD models-->
<!--Discuss the model can be generated with bin centroids or bin means-->
<p>The following demonstration of the packages functionality assumes <code>quollr</code> has been loaded. We also want to load the built-in data sets <code>s_curve_noise_training</code> and <code>s_curve_noise_umap</code>.</p>
<p><code>s_curve_noise_training</code> is a <span class="math inline">\(3\text{-}D\)</span> S-curve data set with additional four noise dimensions which is used to train the model. <code>s_curve_noise_umap</code> is the UMAP <span class="math inline">\(2\text{-}D\)</span> embedding for <code>s_curve_noise_training</code> data set. Each data set contains a unique ID column.</p>
<h4 class="unnumbered" data-number="2.2.1" id="scaling-the-data">Scaling the data</h4>
<p>The algorithm begins by scaling NLDR data to a standard scale using the <code>gen_scaled_data()</code> function. This function standardizes the data and provides the original limits of embeddings and the aspect ratio.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>scaled_nldr_obj_scurve</span> <span class='op'>&lt;-</span> <span class='fu'>gen_scaled_data</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>s_curve_noise_umap</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>s_curve_noise_umap_scaled</span> <span class='op'>&lt;-</span> <span class='va'>scaled_nldr_obj_scurve</span><span class='op'>$</span><span class='va'>scaled_nldr</span></span>
<span></span>
<span><span class='va'>lim1</span> <span class='op'>&lt;-</span> <span class='va'>scaled_nldr_obj_scurve</span><span class='op'>$</span><span class='va'>lim1</span></span>
<span><span class='va'>lim2</span> <span class='op'>&lt;-</span> <span class='va'>scaled_nldr_obj_scurve</span><span class='op'>$</span><span class='va'>lim2</span></span>
<span><span class='va'>r2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>lim2</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>lim1</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<p>The mains steps for the algorithm can be executed by the main function <code>fit_highd_model()</code>, or can be run separately for more flexibility. When constructing the <span class="math inline">\(2\text{-}D\)</span> model, the user can choose either to fit the <span class="math inline">\(2\text{-}D\)</span> model with hexagonal bin centroids or bin means using <code>is_bin_centroid</code> argument.</p>
<p>If a user would like to perform steps of the algorithm themselves, additional user input will be needed for the function that perform each step. For example, if the user wishes to use already binning data, the <code>extract_hexbin_centroids()</code> function can be used directly.</p>
<p>The number of bins along the x-axis, the ratio of the ranges of the original embedding components, the buffer amount as a proportion of data, and if <code>is_rm_lwd_hex = TRUE</code>, benchmark value to remove low density hexagons are parameters that will be determined within <code>fit_highd_model()</code>, if they are not provided. They are created as they are needed throughout the following example. The function <code>fit_highd_model()</code> provides the fitted model in <span class="math inline">\(2\text{-}D\)</span>, and <span class="math inline">\(p\text{-}D\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>fit_highd_model</span><span class='op'>(</span></span>
<span>  highd_data <span class='op'>=</span> <span class='va'>s_curve_noise_training</span>,</span>
<span>  nldr_data <span class='op'>=</span> <span class='va'>s_curve_noise_umap_scaled</span>, </span>
<span>  bin1 <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>  r2 <span class='op'>=</span> <span class='va'>r2</span>,</span>
<span>  q <span class='op'>=</span> <span class='fl'>0.1</span>,</span>
<span>  is_bin_centroid <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<pre><code>$df_bin
# A tibble: 72  8
   hb_id     x1    x2    x3        x4        x5        x6         x7
   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1    13  0.996  1.77  1.07 -0.0117    0.00979  -0.0725   -0.00321  
 2    14  0.829  1.79  1.50 -0.000753 -0.00194  -0.00936  -0.000454 
 3    15  0.307  1.78  1.94 -0.00384   0.00212  -0.00117  -0.000159 
 4    16 -0.175  1.74  1.98  0.00143   0.00320   0.00450  -0.0000763
 5    18 -0.493  1.78  1.87 -0.0100    0.000680  0.0799   -0.000835 
 6    26  0.962  1.22  1.22  0.00107  -0.00260  -0.000948  0.000234 
 7    27  0.631  1.28  1.75  0.000266  0.00174  -0.00158   0.00114  
 8    28  0.139  1.20  1.97 -0.00183   0.000279  0.00177  -0.000666 
 9    29 -0.187  1.00  1.98 -0.00228   0.00461  -0.0506   -0.00472  
10    30 -0.562  1.23  1.82 -0.000563  0.00166  -0.00923  -0.000111 
#  62 more rows

$df_bin_centroids
# A tibble: 72  6
   hexID      c_x      c_y bin_counts std_counts drop_empty
   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;int&gt;      &lt;dbl&gt; &lt;lgl&gt;     
 1    13 -0.0455  0.000514          2     0.0194 FALSE     
 2    14  0.0634  0.000514         81     0.786  FALSE     
 3    15  0.172   0.000514         56     0.544  FALSE     
 4    16  0.281   0.000514         55     0.534  FALSE     
 5    18  0.499   0.000514          2     0.0194 FALSE     
 6    26  0.00894 0.0949           70     0.680  FALSE     
 7    27  0.118   0.0949           78     0.757  FALSE     
 8    28  0.227   0.0949           86     0.835  FALSE     
 9    29  0.336   0.0949            5     0.0485 FALSE     
10    30  0.445   0.0949           54     0.524  FALSE     
#  62 more rows</code></pre>
</div>
<h3 data-number="2.3" id="constructing-the-2text-d-model"><span class="header-section-number">2.3</span> Constructing the <span class="math inline">\(2\text{-}D\)</span> model</h3>
<p>Constructing the <span class="math inline">\(2\text{-}D\)</span> model mainly contains (i) binning data, (ii) obtaining bin centroids, and (iii) indicating neighbors by line segments connecting centroids.</p>
<h4 class="unnumbered" data-number="2.3.1" id="computing-hexagon-grid-configurations">Computing hexagon grid configurations</h4>
<p>The configurations of the hexagonal grid is defined by the number of bins in each direction. To find the number of bins along the y-axis, <code>calc_bins_y()</code> is used. This function takes as input the number of bins along the x-axis, the ratio of the ranges of the original embedding components, and the buffer amount as a proportion of the data. Additionally, this function provides the bin width.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>calc_bins_y</span><span class='op'>(</span></span>
<span>  bin1 <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>  r2 <span class='op'>=</span> <span class='va'>r2</span>,</span>
<span>  q <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<pre><code>$bin2
[1] 13

$a1
[1] 0.1089367

$a2
[1] 0.09434198</code></pre>
</div>
<h4 class="unnumbered" data-number="2.3.2" id="binning-the-data">Binning the data</h4>
<p>Points are allocated to the bins they fall into based on the nearest centroid. The main steps of the hexagonal binning algorithm can be executed using the <code>hex_binning()</code> function, or they can be run separately for greater flexibility. The parameters used within <code>hex_binning()</code> include the scaled NLDR data, the number of bins along the x-axis, the ratio of the ranges of the original embedding components, and the buffer amount as a proportion of the data. The output is an object of the <code>hex_bin_obj</code> class, which contains the number of bins in each direction, the coordinates of the hexagonal grid starting point, the details of bin centroids, the coordinates of bins, embedding components with their corresponding hexagon IDs, hex bins with their corresponding standardized counts, the total number of bins, the number of non-empty bins, and the points within each hexagon.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>hex_binning</span><span class='op'>(</span></span>
<span>  data <span class='op'>=</span> <span class='va'>s_curve_noise_umap_scaled</span>, </span>
<span>  bin1 <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>  r2 <span class='op'>=</span> <span class='va'>r2</span>,</span>
<span>  q <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<pre><code>$a1
[1] 0.1089367

$a2
[1] 0.09434198

$bins
[1] 12 13

$start_point
[1] -0.10000000 -0.09382762

$centroids
# A tibble: 156  3
   hexID      c_x     c_y
   &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1     1 -0.1     -0.0938
 2     2  0.00894 -0.0938
 3     3  0.118   -0.0938
 4     4  0.227   -0.0938
 5     5  0.336   -0.0938
 6     6  0.445   -0.0938
 7     7  0.554   -0.0938
 8     8  0.663   -0.0938
 9     9  0.771   -0.0938
10    10  0.880   -0.0938
#  146 more rows

$hex_poly
# A tibble: 936  3
   hex_poly_id        x       y
         &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1           1 -0.1     -0.0309
 2           1 -0.154   -0.0624
 3           1 -0.154   -0.125 
 4           1 -0.1     -0.157 
 5           1 -0.0455  -0.125 
 6           1 -0.0455  -0.0624
 7           2  0.00894 -0.0309
 8           2 -0.0455  -0.0624
 9           2 -0.0455  -0.125 
10           2  0.00894 -0.157 
#  926 more rows

$data_hb_id
# A tibble: 3,750  4
     emb1   emb2    ID hb_id
    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
 1 0.276  0.915      1   136
 2 0.927  0.347      2    70
 3 0.810  0.242      3    45
 4 0.137  0.657      5    99
 5 0.476  0.799      6   114
 6 0.0485 0.0657     7    26
 7 0.737  0.851      9   129
 8 0.833  0.224     10    45
 9 0.909  0.371     11    70
10 0.0890 0.194     12    38
#  3,740 more rows

$std_cts
# A tibble: 72  3
   hb_id     n std_counts
   &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
 1    13     2     0.0194
 2    14    81     0.786 
 3    15    56     0.544 
 4    16    55     0.534 
 5    18     2     0.0194
 6    26    70     0.680 
 7    27    78     0.757 
 8    28    86     0.835 
 9    29     5     0.0485
10    30    54     0.524 
#  62 more rows

$tot_bins
[1] 156

$non_bins
[1] 72

$pts_bins
# A tibble: 72  2
   hexID pts_list     
   &lt;int&gt; &lt;named list&gt; 
 1   136 &lt;int [3,750]&gt;
 2    70 &lt;int [3,750]&gt;
 3    45 &lt;int [3,750]&gt;
 4    99 &lt;int [3,750]&gt;
 5   114 &lt;int [3,750]&gt;
 6    26 &lt;int [3,750]&gt;
 7   129 &lt;int [3,750]&gt;
 8    38 &lt;int [3,750]&gt;
 9   111 &lt;int [3,750]&gt;
10    14 &lt;int [3,750]&gt;
#  62 more rows

attr(,&quot;class&quot;)
[1] &quot;hex_bin_obj&quot;</code></pre>
</div>
<!--add each step separately-->
<!--add hexbin notation image-->
<h4 class="unnumbered" data-number="2.3.3" id="remove-low-density-hexagons">Remove low-density hexagons</h4>
<p>In certain scenarios, hexagonal bins may contain a few number of points. To ensure comprehensive coverage of NLDR data, it is important to select hexagonal bins with a suitable number of data points. The <code>find_low_dens_hex()</code> function identifies hexagons with low point densities, considering the densities of their neighboring bins as well. Users can initially identify low-density hexagons and then use this function to evaluate how removing them might affect the model fit by examining their neighbors.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>find_low_dens_hex</span><span class='op'>(</span></span>
<span>  df_bin_centroids_all <span class='op'>=</span> <span class='va'>df_bin_centroids</span>, </span>
<span>  bin1 <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>  df_bin_centroids_low <span class='op'>=</span> <span class='va'>df_bin_centroids_low</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="2.3.4" id="indicating-neighbors-by-line-segments-connecting-centroids">Indicating neighbors by line segments connecting centroids</h4>
<p>To indicate neighbors, the <code>tri_bin_centroids()</code> function is used to triangulate bin centroids. Following this, <code>gen_edges()</code> function computes the line segments that connect neighboring bins by providing the triangulated data. This results the coordinates that generate the connecting lines.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tr1_object</span> <span class='op'>&lt;-</span> <span class='fu'>tri_bin_centroids</span><span class='op'>(</span></span>
<span>  hex_df <span class='op'>=</span> <span class='va'>df_bin_centroids</span>, </span>
<span>  x <span class='op'>=</span> <span class='st'>"c_x"</span>, </span>
<span>  y <span class='op'>=</span> <span class='st'>"c_y"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>tr_from_to_df</span> <span class='op'>&lt;-</span> <span class='fu'>gen_edges</span><span class='op'>(</span></span>
<span>  tri_object <span class='op'>=</span> <span class='va'>tr1_object</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In some cases, distant centroids may be connected, resulting in long line segments that can affect the smoothness of the <span class="math inline">\(2\text{-}D\)</span> representation. To address this issue, the <code>find_lg_benchmark()</code> function is used. This function computes a threshold based on the distances of line segments, determining when long edges should be removed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>find_lg_benchmark</span><span class='op'>(</span></span>
<span>  distance_edges <span class='op'>=</span> <span class='va'>distance_df</span>, </span>
<span>  distance_col <span class='op'>=</span> <span class='st'>"distance"</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="2.4" id="lifting-the-model-into-high-dimensions"><span class="header-section-number">2.4</span> Lifting the model into high dimensions</h3>
<p>The final step involves lifting the fitted <span class="math inline">\(2\text{-}D\)</span> model into <span class="math inline">\(p\text{-}D\)</span> by computing the <span class="math inline">\(p\text{-}D\)</span> mean of data points within each bin to represent bin centroids. This transformation is performed using the <code>avg_highd_data()</code> function, which takes <span class="math inline">\(p\text{-}D\)</span> data and their corresponding hexagonal bin IDs as inputs.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>umap_data_with_hb_id</span> <span class='op'>&lt;-</span> <span class='va'>hb_obj</span><span class='op'>$</span><span class='va'>data_hb_id</span></span>
<span></span>
<span><span class='va'>df_all</span> <span class='op'>&lt;-</span> <span class='fu'>bind_cols</span><span class='op'>(</span></span>
<span>  <span class='va'>s_curve_noise_training</span> <span class='op'>|&gt;</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>ID</span><span class='op'>)</span>, </span>
<span>  <span class='va'>umap_data_with_hb_id</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>df_bin</span> <span class='op'>&lt;-</span> <span class='fu'>avg_highd_data</span><span class='op'>(</span></span>
<span>  data <span class='op'>=</span> <span class='va'>df_all</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="2.5" id="prediction"><span class="header-section-number">2.5</span> Prediction</h3>
<p>The <code>predict_emb()</code> function is used to predict <span class="math inline">\(2\text{-}D\)</span> embedding for a new <span class="math inline">\(p\text{-}D\)</span> data point using the fitted model. This function is useful to predict <span class="math inline">\(2\text{-}D\)</span> embedding irrespective of the NLDR technique.</p>
<p>In the prediction process, first, the nearest <span class="math inline">\(p\text{-}D\)</span> model point is identified for a given new <span class="math inline">\(p\text{-}D\)</span> data point by computing <span class="math inline">\(p\text{-}D\)</span> Euclidean distance. Then, the corresponding <span class="math inline">\(2\text{-}D\)</span> bin centroid mapping for the identified <span class="math inline">\(p\text{-}D\)</span> model point is determined. Finally, the coordinates of the identified <span class="math inline">\(2\text{-}D\)</span> bin centroid is used as the predicted NLDR embedding for the new <span class="math inline">\(p\text{-}D\)</span> data point.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>predict_emb</span><span class='op'>(</span></span>
<span>  highd_data <span class='op'>=</span> <span class='va'>s_curve_noise_training</span>, </span>
<span>  model_2d <span class='op'>=</span> <span class='va'>df_bin_centroids</span>, </span>
<span>  model_highd <span class='op'>=</span> <span class='va'>df_bin</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="2.6" id="compute-residuals-and-mean-square-error-mse"><span class="header-section-number">2.6</span> Compute residuals and Mean Square Error (MSE)</h3>
<p>As a Goodness of fit statistics for the model, <code>glance()</code> is used to compute residuals and MSE. These metrics are used to assess how well the fitted model will capture the underlying structure of the <span class="math inline">\(p\text{-}D\)</span> data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>glance</span><span class='op'>(</span></span>
<span>  highd_data <span class='op'>=</span> <span class='va'>s_curve_noise_training</span>, </span>
<span>  model_2d <span class='op'>=</span> <span class='va'>df_bin_centroids</span>, </span>
<span>  model_highd <span class='op'>=</span> <span class='va'>df_bin</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Furthermore, <code>augment()</code> accepts <span class="math inline">\(2\text{-}D\)</span> and <span class="math inline">\(p\text{-}D\)</span> model points, and the <span class="math inline">\(p\text{-}D\)</span> data and adds information about each observation in the data set. Most commonly, this includes predicted values, residuals, row wise total error, absolute error for the fitted values, and row wise total absolute error.</p>
<p>Users can pass data to <code>augment()</code> via either the <code>training_data</code> argument or the <code>newdata</code> argument. If data is passed to the <code>training_data</code> argument, it must be exactly the data that was used to fit the model. Alternatively, datasets can be passed to <code>newdata</code> to augment data that was not used during model fitting. This requires that at least all predictor variable columns used to fit the model are present. If the original outcome variable used to fit the model is not included in <code>newdata</code>, then no corresponding column will be included in the output.</p>
<p>The augmented dataset is always returned as a <code>tibble::tibble</code> with the same number of rows as the passed dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>augment</span><span class='op'>(</span></span>
<span>  highd_data <span class='op'>=</span> <span class='va'>s_curve_noise_training</span>, </span>
<span>  model_2d <span class='op'>=</span> <span class='va'>df_bin_centroids</span>, </span>
<span>  model_highd <span class='op'>=</span> <span class='va'>df_bin</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 data-number="2.7" id="visualizations"><span class="header-section-number">2.7</span> Visualizations</h3>
<p>The package provides five basic visualizations which includes one to visualize the full hexagonal grid in <span class="math inline">\(2\text{-}D\)</span>, three visualizations related to the <span class="math inline">\(2\text{-}D\)</span> model (static visualizations), and one related to the <span class="math inline">\(p\text{-}D\)</span> model (dynamic visualization). Each visualization can be generated using its respective function, as described in this section.</p>
<h4 class="unnumbered" data-number="2.7.1" id="text-d-model-visualization"><span class="math inline">\(2\text{-}D\)</span> model visualization</h4>
<p>The <code>geom_hexgrid()</code> function is used to plot the hexagonal grid from the provided centroid data set.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'>geom_hexgrid</span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>all_centroids_df</span>, </span>
<span>    <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>c_x</span>, y <span class='op'>=</span> <span class='va'>c_y</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>coord_fixed</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>To visualize the <span class="math inline">\(2\text{-}D\)</span> model, mainly three functions are used. As shown in Figure <a href="#fig:mesh-plots"><strong>??</strong></a>a, <code>geom_trimesh()</code> to visualize the triangular mesh by adding a new layer to <code>ggplot()</code>. After identifying benchmark value to remove long edge, <code>vis_lg_mesh()</code> is used to visualize the triangular mesh by coloring the small and long edges. As shown in Figure <a href="#fig:mesh-plots"><strong>??</strong></a>b, the small and long edges are colored by black and red respectively. Following this, <code>vis_rmlg_mesh()</code> is used to visualize smoothed <span class="math inline">\(2\text{-}D\)</span> model which is the <span class="math inline">\(2\text{-}D\)</span> model after removing the long edges (see Figure <a href="#fig:mesh-plots"><strong>??</strong></a>c). In <code>vis_lg_mesh()</code> and <code>vis_rmlg_mesh()</code>, <code>benchmark_value</code> argument controls the edge removal in <span class="math inline">\(2\text{-}D\)</span>. Using small value of <code>benchmark_value</code>, will produce a triangular mesh with missing data structure; for example <code>benchmark_value = 0.3</code> shows two clusters rather than continuous structure, while <code>benchmark_value = 0.8</code> creates long edges and mislead the data structure in <span class="math inline">\(p\text{-}D\)</span> space.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'>geom_trimesh</span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>df_bin_centroids</span>, </span>
<span>    <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>c_x</span>, y <span class='op'>=</span> <span class='va'>c_y</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>coord_fixed</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>vis_lg_mesh</span><span class='op'>(</span></span>
<span>  distance_edges <span class='op'>=</span> <span class='va'>distance_df</span>, </span>
<span>  benchmark_value <span class='op'>=</span> <span class='fl'>0.75</span>, </span>
<span>  tr_coord_df <span class='op'>=</span> <span class='va'>tr_from_to_df</span>, </span>
<span>  distance_col <span class='op'>=</span> <span class='st'>"distance"</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>vis_rmlg_mesh</span><span class='op'>(</span></span>
<span>  distance_edges <span class='op'>=</span> <span class='va'>distance_df</span>, </span>
<span>  benchmark_value <span class='op'>=</span> <span class='fl'>0.75</span>, </span>
<span>  tr_coord_df <span class='op'>=</span> <span class='va'>tr_from_to_df</span>, </span>
<span>  distance_col <span class='op'>=</span> <span class='st'>"distance"</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="2.7.2" id="ptext-d-model-visualization"><span class="math inline">\(p\text{-}D\)</span> model visualization</h4>
<p>Displaying the <span class="math inline">\(p\text{-}D\)</span> model overlaid on the data is done using the function <code>show_langevitour()</code>. This visualization is helpful for visually evaluating how well the model fits the data. The function requires several arguments: data along with their corresponding hexagonal bin ID, <span class="math inline">\(2\text{-}D\)</span> and <span class="math inline">\(p\text{-}D\)</span> model points, the threshold for removing long edges, and the distance data set.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>show_langevitour</span><span class='op'>(</span></span>
<span>  df <span class='op'>=</span> <span class='va'>df_all</span>, </span>
<span>  df_b <span class='op'>=</span> <span class='va'>df_bin</span>, </span>
<span>  df_b_with_center_data <span class='op'>=</span> <span class='va'>df_bin_centroids</span>, </span>
<span>  benchmark_value <span class='op'>=</span> <span class='fl'>0.75</span>, </span>
<span>  distance <span class='op'>=</span> <span class='va'>distance_df</span>, </span>
<span>  distance_col <span class='op'>=</span> <span class='st'>"distance"</span>, </span>
<span>  use_default_benchmark_val <span class='op'>=</span> <span class='cn'>FALSE</span>, </span>
<span>  col_start <span class='op'>=</span> <span class='st'>"x"</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 class="unnumbered" data-number="2.7.3" id="link-plots">Link plots</h4>
<p>There are mainly two interactive link plots can be generated. <code>show_link_plots()</code> helps to examine the fit. The function requires several arguments: points data which contain Non-linear dimension reduction data, high-dimensional data, and high-dimensional model data, and edge data where the from and to links of the edges.</p>
<p><code>show_error_link_plots()</code> helps to see investigate whether the model fits the points everywhere or fits better in some places, or simply mismatches the pattern. The function requires several arguments: points data which contain Non-linear dimension reduction data, high-dimensional data, high-dimensional model data, and model error, and edge data where the from and to links of the edges.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>show_link_plots</span><span class='op'>(</span></span>
<span>  point_df <span class='op'>=</span> <span class='va'>df_exe</span>, </span>
<span>  edge_df <span class='op'>=</span> <span class='va'>distance_small_df</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>show_error_link_plots</span><span class='op'>(</span></span>
<span>  point_df <span class='op'>=</span> <span class='va'>df_exe</span>, </span>
<span>  edge_df <span class='op'>=</span> <span class='va'>distance_small_df</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<!-- ## Tests -->
<!-- All functions have tests written and implemented using the \CRANpkg{testthat} package in R. These tests illuminated issues, allowing meaningful changes and providing insights into some pitfalls of the package. For example, several tests check if there is an NLDR point at the intersection of two bins and determine which bin this point falls into. -->
<!-- Figure xx shows an example of a simulated test set. When creating this test data set,  -->
<!-- <!--discuss a test with how a point in a intersection of two hexagonal going to evaluate-->
<p>&gt;
<!-- <!--selecting the default values to q as 0.1--> &gt;</p>
<!-- # Example -->
<!-- To illustrate the algorithm, we use $5\text{-}D$ simulated data, which we call the "triangular_3d_data". This dataset is generated using the `tri_3d` function from the `cardinalR` package. The dataset generation starts with the initialization of a starting point $p_0 = (x_0, y_0, z_0)$ randomly selected within the $3\text{-}D$ space using a uniform distribution. Four fixed corner points of a tetrahedron are defined as $c_1 = (0, 0, 0)$, $c_2 = (1, 0, 0)$, $c_3 = (0.5, 1, 0)$, and $c_4 = (0.5, 0.5, 1)$. For each point $p_i$ where $i = 1, 2, \ldots, n$, one of the corner points $c_j$ (where $j \in \{1, 2, 3, 4\}$) is selected randomly, and the new point $p_i$ is computed as the midpoint between the current point $p_{i-1}$ and the selected corner point $c_j$: $p_i = \frac{p_{i-1} + c_j}{2}$. This iterative process ensures that each new point moves closer to one of the corners, creating a fractal-like triangular distribution of points. The coordinates of each generated point $p_i$ form the variables $X_1, X_2, X_3$. The remaining variables $X_4, X_5$ are all uniform error, with small variance. We would consider $T=(X_1, X_2, X_3)$ to be the true model. -->
<!-- ```{r} -->
<!-- triangular_3d_data <- tri_3d( -->
<!--   n = 1250, num_noise = 2,  -->
<!--   min_n = -0.05, max_n = 0.05) |> -->
<!--   as_tibble()  -->
<!-- colnames(triangular_3d_data) <- paste0("x", 1:NCOL(triangular_3d_data)) -->
<!-- langevitour::langevitour(triangular_3d_data) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- triangular_3d_data <- triangular_3d_data |> -->
<!--   mutate(ID = row_number()) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- sc_ltr_pos <- c(0.08, 0.96) -->
<!-- ``` -->
<!-- <!--tSNE with perplexity = 6-->
<p>&gt;
<!-- ```{r} -->
<!-- tSNE_fit1 <- triangular_3d_data |> -->
<!--   select(-ID) |> -->
<!--   Rtsne(perplexity = 6)  --></p>
<!-- tsne_prism1 <- tSNE_fit1$Y |> -->
<!--   as_tibble() |> -->
<!--   mutate(ID = row_number()) -->
<!-- colnames(tsne_prism1) <- c("tSNE1", "tSNE2", "ID") -->
<!-- prism_scaled_obj_tsne1 <- gen_scaled_data( -->
<!--   data = tsne_prism1) -->
<!-- tsne_prism_scaled1 <- prism_scaled_obj_tsne1$scaled_nldr -->
<!-- nldr_prism1 <- tsne_prism_scaled1 |>  -->
<!--   ggplot(aes(x = tSNE1, y = tSNE2)) +  -->
<!--   geom_point(alpha=0.5, colour="#000000", size = 0.5)  -->
<!-- ``` -->
<!-- <!--tSNE with perplexity = 35-->
<p>&gt;
<!-- ```{r} -->
<!-- tSNE_fit2 <- triangular_3d_data |> -->
<!--   select(-ID) |> -->
<!--   Rtsne(perplexity = round(sqrt(NROW(triangular_3d_data))))  --></p>
<!-- tsne_prism2 <- tSNE_fit2$Y |> -->
<!--   as_tibble() |> -->
<!--   mutate(ID = row_number()) -->
<!-- colnames(tsne_prism2) <- c("tSNE1", "tSNE2", "ID") -->
<!-- prism_scaled_obj_tsne2 <- gen_scaled_data( -->
<!--   data = tsne_prism2) -->
<!-- tsne_prism_scaled2 <- prism_scaled_obj_tsne2$scaled_nldr -->
<!-- nldr_prism2 <- tsne_prism_scaled2 |>  -->
<!--   ggplot(aes(x = tSNE1, y = tSNE2)) +  -->
<!--   geom_point(alpha=0.5, colour="#000000", size = 0.5)  -->
<!-- ``` -->
<!-- <!--tSNE with perplexity = 58-->
<p>&gt;
<!-- ```{r} -->
<!-- tSNE_fit3 <- triangular_3d_data |> -->
<!--   select(-ID) |> -->
<!--   Rtsne(perplexity = 58)  --></p>
<!-- tsne_prism3 <- tSNE_fit3$Y |> -->
<!--   as_tibble() |> -->
<!--   mutate(ID = row_number()) -->
<!-- colnames(tsne_prism3) <- c("tSNE1", "tSNE2", "ID") -->
<!-- prism_scaled_obj_tsne3 <- gen_scaled_data( -->
<!--   data = tsne_prism3) -->
<!-- tsne_prism_scaled3 <- prism_scaled_obj_tsne3$scaled_nldr -->
<!-- nldr_prism3 <- tsne_prism_scaled3 |>  -->
<!--   ggplot(aes(x = tSNE1, y = tSNE2)) +  -->
<!--   geom_point(alpha=0.5, colour="#000000", size = 0.5)  -->
<!-- ``` -->
<!-- <!--UMAP with n_neighbors = 15 and min_dist = 0.3-->
<p>&gt;
<!-- ```{r} -->
<!-- umap_prism1 <- triangular_3d_data |> -->
<!--   select(-ID) |> -->
<!--   umap(n_neighbors = 15, n_components =  2,  -->
<!--        metric = "euclidean", min_dist = 0.3, init = "spca") --></p>
<!-- umap_prism1 <- umap_prism1 |> -->
<!--   as_tibble() -->
<!-- names(umap_prism1) <- c("UMAP1", "UMAP2") -->
<!-- umap_prism1 <- umap_prism1 |> -->
<!--   mutate(ID = 1:NROW(umap_prism1)) -->
<!-- prism_scaled_obj_umap1 <- gen_scaled_data( -->
<!--   data = umap_prism1) -->
<!-- umap_prism_scaled1 <- prism_scaled_obj_umap1$scaled_nldr -->
<!-- nldr_prism4 <- umap_prism_scaled1 |>  -->
<!--   ggplot(aes(x = UMAP1, y = UMAP2)) +  -->
<!--   geom_point(alpha=0.5, colour="#000000", size = 0.5)  -->
<!-- ``` -->
<!-- <!--UMAP with n_neighbors = 35 and min_dist = 0.5-->
<p>&gt;
<!-- ```{r} -->
<!-- umap_prism2 <- triangular_3d_data |> -->
<!--   select(-ID) |> -->
<!--   umap(n_neighbors = 35, n_components =  2,  -->
<!--        metric = "euclidean", min_dist = 0.5, init = "spca") --></p>
<!-- umap_prism2 <- umap_prism2 |> -->
<!--   as_tibble() -->
<!-- names(umap_prism2) <- c("UMAP1", "UMAP2") -->
<!-- umap_prism2 <- umap_prism2 |> -->
<!--   mutate(ID = 1:NROW(umap_prism2)) -->
<!-- prism_scaled_obj_umap2 <- gen_scaled_data( -->
<!--   data = umap_prism2) -->
<!-- umap_prism_scaled2 <- prism_scaled_obj_umap2$scaled_nldr -->
<!-- nldr_prism5 <- umap_prism_scaled2 |>  -->
<!--   ggplot(aes(x = UMAP1, y = UMAP2)) +  -->
<!--   geom_point(alpha=0.5, colour="#000000", size = 0.5)  -->
<!-- ``` -->
<!-- <!--UMAP with n_neighbors = 69 and min_dist = 0.6-->
<p>&gt;
<!-- ```{r} -->
<!-- umap_prism3 <- triangular_3d_data |> -->
<!--   select(-ID) |> -->
<!--   umap(n_neighbors = 69, n_components =  2,  -->
<!--        metric = "euclidean", min_dist = 0.6, init = "spca") --></p>
<!-- umap_prism3 <- umap_prism3 |> -->
<!--   as_tibble() -->
<!-- names(umap_prism3) <- c("UMAP1", "UMAP2") -->
<!-- umap_prism3 <- umap_prism3 |> -->
<!--   mutate(ID = 1:NROW(umap_prism3)) -->
<!-- prism_scaled_obj_umap3 <- gen_scaled_data( -->
<!--   data = umap_prism3) -->
<!-- umap_prism_scaled3 <- prism_scaled_obj_umap3$scaled_nldr -->
<!-- nldr_prism6 <- umap_prism_scaled3 |>  -->
<!--   ggplot(aes(x = UMAP1, y = UMAP2)) +  -->
<!--   geom_point(alpha=0.5, colour="#000000", size = 0.5)  -->
<!-- ``` -->
<!-- ```{r} -->
<!-- nldr_prism1 + nldr_prism2 + nldr_prism3 +  -->
<!--   nldr_prism4 + nldr_prism5 + nldr_prism6 + -->
<!--   plot_layout(ncol=3) -->
<!-- ``` -->
<!-- <!--need to add details regarding which differences can I see with different layouts-->
<p>&gt;</p>
<!-- ## Deciding an appropriate fit -->
<!-- <!--select based on looking at b_non_empty vs log(Error)-->
<p>&gt;
<!-- <!--select a choice for b_non_empty--> &gt;</p>
<!-- <!--compute error with tSNE and different perplexity values-->
<p>&gt;
<!-- ```{r} -->
<!-- error_prism_tsne <- data.frame(matrix(nrow = 0, ncol = 0)) --></p>
<!-- ## To initialize number of bins along the x-axis -->
<!-- bin1_vec_prism <- 4:25  -->
<!-- perplexity_vec <- c(6, 35, 58) -->
<!-- for (perplexity_val in perplexity_vec) { -->
<!--   tSNE_fit <- triangular_3d_data |> -->
<!--     select(-ID) |> -->
<!--     Rtsne(perplexity = perplexity_val) -->
<!--   tsne_prism <- tSNE_fit$Y |> -->
<!--     as_tibble() |> -->
<!--     mutate(ID = row_number()) -->
<!--   colnames(tsne_prism) <- c("tSNE1", "tSNE2", "ID") -->
<!--   prism_scaled_obj <- gen_scaled_data( -->
<!--     data = tsne_prism) -->
<!--   tsne_prism_scaled <- prism_scaled_obj$scaled_nldr -->
<!--   lim1 <- prism_scaled_obj$lim1 -->
<!--   lim2 <- prism_scaled_obj$lim2 -->
<!--   r2_prism <- diff(lim2)/diff(lim1)  -->
<!--   for (xbins in bin1_vec_prism) { -->
<!--     bin2 <- calc_bins_y(bin1 = xbins, r2 = r2_prism)$bin2 -->
<!--     prism_model <- fit_highd_model( -->
<!--       training_data = triangular_3d_data, -->
<!--       emb_df = tsne_prism_scaled, -->
<!--       bin1 = xbins, -->
<!--       r2 = r2_prism, -->
<!--       is_bin_centroid = TRUE, -->
<!--       is_rm_lwd_hex = TRUE, -->
<!--       col_start_highd = "x" -->
<!--     ) -->
<!--     df_bin_centroids_prism <- prism_model$df_bin_centroids -->
<!--     df_bin_prism <- prism_model$df_bin -->
<!--     ## Compute error -->
<!--     error_df <- glance( -->
<!--       df_bin_centroids = df_bin_centroids_prism, -->
<!--       df_bin = df_bin_prism, -->
<!--       training_data = triangular_3d_data, -->
<!--       newdata = NULL, -->
<!--       type_NLDR = "tSNE", -->
<!--       col_start = "x") |> -->
<!--       mutate(bin1 = xbins, -->
<!--              bin2 = bin2, -->
<!--              b = bin1 * bin2, -->
<!--              b_non_empty = NROW(df_bin_centroids_prism), -->
<!--              type = paste0("perplexity: ", perplexity_val)) -->
<!--     error_prism_tsne <- bind_rows(error_prism_tsne, error_df) -->
<!--   } -->
<!-- } -->
<!-- ``` -->
<!-- <!--compute error with UMAP and different parameter values-->
<p>&gt;
<!-- ```{r} -->
<!-- error_prism_umap <- data.frame(matrix(nrow = 0, ncol = 0)) --></p>
<!-- ## To initialize number of bins along the x-axis -->
<!-- bin1_vec_prism <- 4:25  -->
<!-- param_list <- list(param1 = c(15, 0.3), param2 = c(35, 0.5), param3 = c(69, 0.6)) -->
<!-- for (i in 1:length(param_list)) { -->
<!--   n_neighbors_val <- param_list[[i]][1] -->
<!--   min_dist_val <- param_list[[i]][2] -->
<!--   umap_prism <- triangular_3d_data |> -->
<!--     select(-ID) |> -->
<!--     umap(n_neighbors = n_neighbors_val, n_components =  2,  -->
<!--          metric = "euclidean", min_dist = min_dist_val, init = "spca") -->
<!--   umap_prism <- umap_prism |> -->
<!--     as_tibble() -->
<!--   names(umap_prism) <- c("UMAP1", "UMAP2") -->
<!--   umap_prism <- umap_prism |> -->
<!--     mutate(ID = 1:NROW(umap_prism)) -->
<!--   prism_scaled_obj <- gen_scaled_data( -->
<!--     data = umap_prism) -->
<!--   umap_prism_scaled <- prism_scaled_obj$scaled_nldr -->
<!--   lim1 <- prism_scaled_obj$lim1 -->
<!--   lim2 <- prism_scaled_obj$lim2 -->
<!--   r2_prism <- diff(lim2)/diff(lim1)  -->
<!--   for (xbins in bin1_vec_prism) { -->
<!--     bin2 <- calc_bins_y(bin1 = xbins, r2 = r2_prism)$bin2 -->
<!--     prism_model <- fit_highd_model( -->
<!--       training_data = triangular_3d_data, -->
<!--       emb_df = umap_prism_scaled, -->
<!--       bin1 = xbins, -->
<!--       r2 = r2_prism, -->
<!--       is_bin_centroid = TRUE, -->
<!--       is_rm_lwd_hex = TRUE, -->
<!--       col_start_highd = "x" -->
<!--     ) -->
<!--     df_bin_centroids_prism <- prism_model$df_bin_centroids -->
<!--     df_bin_prism <- prism_model$df_bin -->
<!--     ## Compute error -->
<!--     error_df <- glance( -->
<!--       df_bin_centroids = df_bin_centroids_prism, -->
<!--       df_bin = df_bin_prism, -->
<!--       training_data = triangular_3d_data, -->
<!--       newdata = NULL, -->
<!--       type_NLDR = "UMAP", -->
<!--       col_start = "x") |> -->
<!--       mutate(bin1 = xbins, -->
<!--              bin2 = bin2, -->
<!--              b = bin1 * bin2, -->
<!--              b_non_empty = NROW(df_bin_centroids_prism), -->
<!--              type = paste0("n_neighbors: ", n_neighbors_val,  -->
<!--                            " min_dist: ", min_dist_val)) -->
<!--     error_prism_umap <- bind_rows(error_prism_umap, error_df) -->
<!--   } -->
<!-- } -->
<!-- ``` -->
<!-- ```{r} -->
<!-- error_prism <- bind_rows(error_prism_tsne, error_prism_umap)  -->
<!-- error_prism <- error_prism |> -->
<!--   filter(b <= 625) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- error_plot_prism <- ggplot(error_prism,  -->
<!--                            aes(x = b_non_empty,  -->
<!--                                y = log(Error),  -->
<!--                                group = type,  -->
<!--                                colour = type)) +  -->
<!--   geom_point(size = 1) + -->
<!--   geom_line() +  -->
<!--   geom_vline(xintercept = 112, linetype="solid", -->
<!--              color = "black", linewidth=0.8, alpha = 0.5) + -->
<!--   scale_color_manual(values=c('#e41a1c','#377eb8','#4daf4a','#984ea3', -->
<!--                               '#ff7f00','#a6cee3','#a65628','#f781bf')) + -->
<!--   ylab("log(Error)") + -->
<!--   xlab("number of non-empty bins") + -->
<!--   theme(axis.text.x = element_text(size = 5), -->
<!--         axis.text.y = element_text(size = 5), -->
<!--         axis.title.x = element_text(size = 5), -->
<!--         axis.title.y = element_text(size = 5, angle = 90), -->
<!--         legend.position = "bottom") -->
<!-- error_plot_prism -->
<!-- ``` -->
<!-- <!--selected tSNE perplexity: 35-->
<p>&gt;</p>
<!-- ## Fit the appropriate model -->
<!-- ### Construct model in $2\text{-}D$ -->
<!-- ### Selecting parameter values for the model -->
<!-- #### Choice of bins -->
<!-- #### Removal of low-density bins -->
<!-- #### Removing long edges -->
<!-- ```{r} -->
<!-- ## Compute hexbin parameters -->
<!-- num_bins_x_prism <- 21 -->
<!-- lim1 <- prism_scaled_obj_tsne2$lim1 -->
<!-- lim2 <- prism_scaled_obj_tsne2$lim2 -->
<!-- r2_prism <- diff(lim2)/diff(lim1)  -->
<!-- prism_model <- fit_highd_model( -->
<!--   training_data = triangular_3d_data, -->
<!--   emb_df = tsne_prism_scaled2, -->
<!--   bin1 = num_bins_x_prism, -->
<!--   r2 = r2_prism, -->
<!--   is_bin_centroid = TRUE, -->
<!--   is_rm_lwd_hex = TRUE, -->
<!--   col_start_highd = "x" -->
<!-- ) -->
<!-- df_bin_centroids_prism <- prism_model$df_bin_centroids -->
<!-- df_bin_prism <- prism_model$df_bin -->
<!-- ## Triangulate bin centroids -->
<!-- tr1_object_prism <- tri_bin_centroids( -->
<!--   df_bin_centroids_prism, x = "c_x", y = "c_y") -->
<!-- tr_from_to_df_prism <- gen_edges( -->
<!--   tri_object = tr1_object_prism) -->
<!-- ## Compute 2D distances -->
<!-- distance_prism <- cal_2d_dist( -->
<!--   tr_coord_df = tr_from_to_df_prism, -->
<!--   start_x = "x_from", -->
<!--   start_y = "y_from", -->
<!--   end_x = "x_to", -->
<!--   end_y = "y_to", -->
<!--   select_vars = c("from", "to", "distance")) -->
<!-- ## To find the benchmark value -->
<!-- benchmark_prism <- find_lg_benchmark( -->
<!--   distance_edges = distance_prism, -->
<!--   distance_col = "distance") -->
<!-- trimesh_removed_prism <- vis_rmlg_mesh( -->
<!--   distance_edges = distance_prism, -->
<!--   benchmark_value = benchmark_prism, -->
<!--   tr_coord_df = tr_from_to_df_prism, -->
<!--   distance_col = "distance") #+ -->
<!-- #xlim(sc_xlims) + ylim(sc_ylims) + -->
<!-- #interior_annotation("a", sc_ltr_pos) -->
<!-- trimesh_removed_prism -->
<!-- ``` -->
<!-- ### Lifting the model into $p\text{-}D$ -->
<!-- ```{r} -->
<!-- ## Hexagonal binning to have regular hexagons -->
<!-- hb_obj_prism <- hex_binning( -->
<!--   data = tsne_prism_scaled2, -->
<!--   bin1 = num_bins_x_prism, -->
<!--   r2 = r2_prism) -->
<!-- tsne_data_with_hb_id <- hb_obj_prism$data_hb_id -->
<!-- df_all_prism <- dplyr::bind_cols(triangular_3d_data |> dplyr::select(-ID), -->
<!--                                  tsne_data_with_hb_id) -->
<!-- ### Define type column -->
<!-- df <- df_all_prism |> -->
<!--   dplyr::select(tidyselect::starts_with("x")) |> -->
<!--   dplyr::mutate(type = "data") ## original dataset -->
<!-- df_b <- df_bin_prism |> -->
<!--   dplyr::filter(hb_id %in% df_bin_centroids_prism$hexID) |> -->
<!--   dplyr::mutate(type = "model") ## Data with summarized mean -->
<!-- ## Reorder the rows of df_b according to the hexID order in df_b_with_center_data -->
<!-- df_b <- df_b[match(df_bin_centroids_prism$hexID, df_b$hb_id),] |> -->
<!--   dplyr::select(-hb_id) -->
<!-- df_exe <- dplyr::bind_rows(df_b, df) -->
<!-- ## Set the maximum difference as the criteria -->
<!-- distance_df_small_edges <- distance_prism |> -->
<!--   dplyr::filter(distance < benchmark_prism) -->
<!-- ## Since erase brushing is considerd. -->
<!-- langevitour::langevitour(df_exe[1:(length(df_exe)-1)], -->
<!--                          lineFrom = distance_df_small_edges$from, -->
<!--                          lineTo = distance_df_small_edges$to, -->
<!--                          group = df_exe$type, pointSize = append(rep(0, NROW(df_b)), rep(0.8, NROW(df))), -->
<!--                          levelColors = c("#6a3d9a", "#33a02c")) -->
<!-- ``` -->
<!-- What can I see in high-D? -->
<!-- - Four clusters that are really close  -->
<!-- What can I see in 2D layout? -->
<!-- - Several clusters (more that what see in high-D) -->
<!-- What can learn from the model? -->
<!-- - There are four clusters, but not as the same cluster what data shows. In 2D, the two of actual clusters (high-D clusters) are really close. Also, one of the big high-D cluster is separated to two sub clusters. -->
<h2 data-number="3" id="application"><span class="header-section-number">3</span> Application</h2>
<p>Need to find another application</p>
<p><a href="https://www.nature.com/articles/s41586-018-0590-4#data-availability" class="uri">https://www.nature.com/articles/s41586-018-0590-4#data-availability</a> <!--paper-->
<a href="https://figshare.com/articles/dataset/Robject_files_for_tissues_processed_by_Seurat/5821263/1" class="uri">https://figshare.com/articles/dataset/Robject_files_for_tissues_processed_by_Seurat/5821263/1</a> <!--data--></p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<!-- Assessing which of the 8 NLDR layouts on the limb3k data  (shown in @fig-NLDR-variety) is the better representation using MSE for varying binwidth ($a_1$). Colour  used for the lines and points in the left plot and in the scatterplots represents NLDR layout (a-h). Layout f is universally poor. Layouts a, c, g, h that show large separations between clusters are universally suboptimal. Layout d with little separation performs well at tiny binwidth (where most points are in their own bin) and poorly as binwidth increases. The choice of best is between layouts b and e, that have small separations between oddly shaped clusters. Layout e is the best choice.-->
<div class="layout-chunk" data-layout="l-body">
<p><img src="paper-quollr_files/figure-html5/fig-limb-mse-1.png" width="100%" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="paper-quollr_files/figure-html5/unnamed-chunk-20-1.png" width="100%" /></p>
</div>
<h2 data-number="4" id="discussion"><span class="header-section-number">4</span> Discussion</h2>
<p>This paper presents the R package <code>quollr</code> to develop a way to take the fitted model, as represented by the positions of points in <span class="math inline">\(2\text{-}D\)</span>, and turn it into a high-dimensional wireframe to overlay on the data, viewing it with a tour.</p>
<p>The paper includes a clustering example to illustrate how <code>quollr</code> is useful to assess which NLDR technique and which (hyper)parameter choice gives the most accurate representation. In addition, how to select parameters for hexagonal binning and fitting model are explained.</p>
<p>Possible future improvements would be<!--assess the preservation of local and glocal structure w.r.t 2D and high-D distance comparison--></p>
<p>This new tool provides an effective start point for automatically creating regular hexagons and help to evaluate which NLDR technique and which hyperparameter choice gives the most accurate representation of <span class="math inline">\(p\text{-}D\)</span> data.</p>
<h2 data-number="5" id="acknowledgements"><span class="header-section-number">5</span> Acknowledgements</h2>
<p>This article is created using <a href="https://cran.r-project.org/package=knitr">knitr</a> <span class="citation" data-cites="knitr">(<a href="#ref-knitr" role="doc-biblioref">Xie 2015</a>)</span> and <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a> <span class="citation" data-cites="rmarkdown">(<a href="#ref-rmarkdown" role="doc-biblioref">Xie et al. 2018</a>)</span> in R with the <code>rjtools::rjournal_article</code> template. The source code for reproducing this paper can be found at: <a href="https://github.com/JayaniLakshika/paper-quollr" class="uri">https://github.com/JayaniLakshika/paper-quollr</a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 class="appendix" data-number="5.1" id="cran-packages-used"><span class="header-section-number">5.1</span> CRAN packages used</h3>
<p><a href="https://cran.r-project.org/package=quollr">quollr</a>, <a href="https://cran.r-project.org/package=cardinalR">cardinalR</a>, <a href="https://cran.r-project.org/package=testthat">testthat</a>, <a href="https://cran.r-project.org/package=knitr">knitr</a>, <a href="https://cran.r-project.org/package=rmarkdown">rmarkdown</a></p>
<h3 class="appendix" data-number="5.2" id="cran-task-views-implied-by-cited-packages"><span class="header-section-number">5.2</span> CRAN Task Views implied by cited packages</h3>
<p><a href="https://cran.r-project.org/view=ReproducibleResearch">ReproducibleResearch</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-dan2023" class="csl-entry" role="listitem">
D. Carr, ported by Nicholas Lewin-Koh, M. Maechler and contains copies of lattice functions written by Deepayan Sarkar. <em>Hexbin: Hexagonal binning routines.</em> 2023. URL <a href="https://CRAN.R-project.org/package=hexbin">https://CRAN.R-project.org/package=hexbin</a>. R package version 1.28.3.
</div>
<div id="ref-knitr" class="csl-entry" role="listitem">
Y. Xie. <em>Dynamic documents with <span>R</span> and knitr.</em> 2nd ed Boca Raton, Florida: Chapman; Hall/CRC, 2015. URL <a href="https://yihui.name/knitr/">https://yihui.name/knitr/</a>. ISBN 978-1498716963.
</div>
<div id="ref-rmarkdown" class="csl-entry" role="listitem">
Y. Xie, J. J. Allaire and G. Grolemund. <em><span>R</span> markdown: The definitive guide.</em> Boca Raton, Florida: Chapman; Hall/CRC, 2018. URL <a href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>. ISBN 978-1138359338.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
<h3 id="citation">Citation</h3>
<p>For attribution, please cite this work as</p>
<pre class="citation-appendix short">Lakshika, et al., "quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space", The R Journal, 2025</pre>
<p>BibTeX citation</p>
<pre class="citation-appendix long">@article{paper-quollr,
  author = {Lakshika, Jayani P.G. and Cook, Dianne and Harrison, Paul and Lydeamore, Michael and Talagala, Thiyanga S.},
  title = {quollr: An R Package for Visualizing $2-D$ Models from Non-linear Dimension Reductions in High Dimensional Space},
  journal = {The R Journal},
  year = {2025},
  issn = {2073-4859},
  pages = {1}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
