% !TeX root = RJwrapper.tex
\title{quollr: An R Package for Visualizing 2D Models from Nonlinear Dimension Reductions in High Dimensional Space}


\author{by Jayani P.G. Lakshika, Dianne Cook, Paul Harrison, Michael Lydeamore, and Thiyanga S. Talagala}

\maketitle

\abstract{%
An abstract of less than 150 words.
}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

\hypertarget{methodology}{%
\section{Methodology}\label{methodology}}

\hypertarget{implementation}{%
\section{Implementation}\label{implementation}}

The package can be installed from CRAN:

\texttt{install.packages("quollr")}

The development version can be installed from GitHub:

\texttt{devtools::install\_github("JayaniLakshika/quollr")}

The following demonstration of the package's functionality assumes \texttt{quollr} has been loaded. We also want to load the built-in data sets \texttt{s\_curve\_noise\_training} and \texttt{s\_curve\_noise\_umap}.

The mains steps for the algorithm can be executed by the main function \texttt{fit\_highd\_model()}, or can be run separately for more flexibility. When constructing the 2D model, the user can choose either to fir the 2D model with hexagonal bin centroids or bin means using \texttt{is\_bin\_centroid} argument.

\includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-1-1.pdf}

\hypertarget{constructing-the-2d-model}{%
\subsection{Constructing the 2D model}\label{constructing-the-2d-model}}

\hypertarget{preprocessing}{%
\subsubsection{Preprocessing}\label{preprocessing}}

The function \texttt{gen\_scaled\_data()} is used to prepare the NLDR data to fit within the bounds required for regular hexagonal binning, ensuring effective visualization.

\hypertarget{binning-data}{%
\subsubsection{Binning data}\label{binning-data}}

The mains steps for the hexagonal binning algorithm can be executed by the main function \texttt{hex\_binning()}, or can be run separately for more flexibility.

\textbf{Step 1: Compute hexagonal grid configurations}

\textbf{Step 2: Generate the hexagonal bin centroids}

\textbf{Step 3: Create the hexagonal grid}

\textbf{Step 4: Assign NLDR data to hexagons}

\hypertarget{obtain-bin-centroids-means}{%
\subsubsection{Obtain bin centroids/ means}\label{obtain-bin-centroids-means}}

To obtain hexagonal bin centroids, \texttt{extract\_hexbin\_centroids()}is used. The function \texttt{extract\_hexbin\_mean()} is used to obtain average within each hexagon.

\hypertarget{triangulate-bin-centroids-means}{%
\subsubsection{Triangulate bin centroids/ means}\label{triangulate-bin-centroids-means}}

The \texttt{tri\_bin\_centroids()} is used to do triangulate bin centroids/ bin means. Then, \texttt{gen\_edges()} compute the edges to obtain the triangular mesh which is the 2D model.

\hypertarget{lifting-the-model-into-high-dimensions}{%
\subsection{Lifting the model into high dimensions}\label{lifting-the-model-into-high-dimensions}}

The \(p\)-D model is generated by \texttt{avg\_highd\_data()} by passing the \(p\)-D data.

\hypertarget{tuning-model-parameters}{%
\subsection{Tuning model parameters}\label{tuning-model-parameters}}

Mainly there are two model parameter need to consider: benchmark value to remove the low-density hexagons, and benchmark value to remove the long edges. \texttt{find\_low\_dens\_hex()} is used to find the hexagons which contains less number of points by considering the density of their neighboring points as well. In here, user can first decide which are the low-density hexagons and pass them to this function to check whether these removal of low-density hexagons can affect the model fit by looking at the the neighbors. On the other hand, \texttt{find\_lg\_benchmark()} function is used to compute the threshold for removing long edges.

\hypertarget{compute-residuals-and-mean-square-error-mse}{%
\subsection{Compute residuals and Mean Square Error (MSE)}\label{compute-residuals-and-mean-square-error-mse}}

As a Goodness of fit statistics for the model, \texttt{gen\_summary()} is used to compute residuals and MSE. For the fitted model, how residuals and MSE is changing is shown in Figure 2.

\hypertarget{visualizations}{%
\subsection{Visualizations}\label{visualizations}}

The package provides four basic visualizations which includes three visualizations regarding 2D model (static vis) and one is regrading \(p\)-D model (dynamic vis). Each visualization can be done their own functions which describes in this section.

\hypertarget{d-model-visualization}{%
\subsubsection{2D model visualization}\label{d-model-visualization}}

To visualize the 2D model, mainly three functions are used. As shown in Figure 1, \texttt{geom\_trimesh()} to visualize the triangular mesh by adding a new layer to \texttt{ggplot()}. After identifying benchmark value to remove long edge, \texttt{vis\_lg\_mesh()} is used to visualize the triangular mesh by coloring the small and long edges. As shown in Figure 1, the small and long edges are colored by black and red respectively. Following this, \texttt{vis\_rmlg\_mesh()} is used to visualize smoothed 2D model which is the 2D model after removing the long edges (see Figure 1). In \texttt{vis\_lg\_mesh()} and \texttt{vis\_rmlg\_mesh()}, \texttt{benchmark\_value} argument controls the edge removal in 2D.

\hypertarget{p-d-model-visualization}{%
\subsubsection{p-D model visualization}\label{p-d-model-visualization}}

The \(p\)-D model overlaid on data is visualized by the function \texttt{show\_langevitour()}. This is a useful dynamic visualization result to validate visually whether the model fits the data well or not.

\hypertarget{prediction}{%
\subsection{Prediction}\label{prediction}}

\texttt{predict\_emb()} function is used to predict 2D embedding for a new data point using the fitted model. This function is useful to predict 2D embedding irrespective of the NLDR technique.

\hypertarget{tests}{%
\subsection{Tests}\label{tests}}

All functions have tests written and implemented using the \CRANpkg{testthat} (Wickham 2011) in R.

\hypertarget{application}{%
\section{Application}\label{application}}

\includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-4-1.pdf}

\includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-5-1.pdf}

\includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-7-1.pdf}

\includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-8-1.pdf} \includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-8-2.pdf}

\includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-9-1.pdf} \includegraphics{paper-quollr_files/figure-latex/unnamed-chunk-9-2.pdf}

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

\hypertarget{acknowledgements}{%
\section{Acknowledgements}\label{acknowledgements}}

This article is created using \CRANpkg{knitr} (Xie 2015) and \CRANpkg{rmarkdown} (Xie, Allaire, and Grolemund 2018) in R with the \texttt{rjtools::rjournal\_article} template. The source code for reproducing this paper can be found at: \url{https://github.com/JayaniLakshika/paper-quollr}.

\hypertarget{references}{%
\section*{References}\label{references}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-testthat}{}}%
Wickham, Hadley. 2011. {``Testthat: Get Started with Testing.''} \emph{The R Journal} 3: 5--10. \url{https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf}.

\leavevmode\vadjust pre{\hypertarget{ref-knitr}{}}%
Xie, Yihui. 2015. \emph{Dynamic Documents with {R} and Knitr}. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. \url{https://yihui.name/knitr/}.

\leavevmode\vadjust pre{\hypertarget{ref-rmarkdown}{}}%
Xie, Yihui, J. J. Allaire, and Garrett Grolemund. 2018. \emph{{R} Markdown: The Definitive Guide}. Boca Raton, Florida: Chapman; Hall/CRC. \url{https://bookdown.org/yihui/rmarkdown}.

\end{CSLReferences}


\address{%
Jayani P.G. Lakshika\\
Monash University\\%
Department of Econometrics and Business Statistics, VIC 3800 Australia\\
%
\url{https://jayanilakshika.netlify.app/}\\%
\textit{ORCiD: \href{https://orcid.org/0000-0002-6265-6481}{0000-0002-6265-6481}}\\%
\email{jayani.piyadigamage@monash.edu}%
}

\address{%
Dianne Cook\\
Monash University\\%
Department of Econometrics and Business Statistics, VIC 3800 Australia\\
%
\url{http://www.dicook.org/}\\%
\textit{ORCiD: \href{https://orcid.org/0000-0002-3813-7155}{0000-0002-3813-7155}}\\%
\href{mailto:dicook@monash.edu}{\nolinkurl{dicook@monash.edu}}%
}

\address{%
Paul Harrison\\
Monash University\\%
MGBP, BDInstitute, VIC 3800 Australia\\
%
%
\textit{ORCiD: \href{https://orcid.org/0000-0002-3980-268X}{0000-0002-3980-268X}}\\%
\href{mailto:paul.harrison@monash.edu}{\nolinkurl{paul.harrison@monash.edu}}%
}

\address{%
Michael Lydeamore\\
Monash University\\%
Department of Econometrics and Business Statistics, VIC 3800 Australia\\
%
%
\textit{ORCiD: \href{https://orcid.org/0000-0001-6515-827X}{0000-0001-6515-827X}}\\%
\href{mailto:michael.lydeamore@monash.edu}{\nolinkurl{michael.lydeamore@monash.edu}}%
}

\address{%
Thiyanga S. Talagala\\
University of Sri Jayewardenepura\\%
Department of Statistics, Gangodawila, Nugegoda 10100 Sri Lanka\\
%
\url{https://thiyanga.netlify.app/}\\%
\textit{ORCiD: \href{https://orcid.org/0000-0002-0656-9789}{0000-0002-0656-9789}}\\%
\href{mailto:ttalagala@sjp.ac.lk}{\nolinkurl{ttalagala@sjp.ac.lk}}%
}
