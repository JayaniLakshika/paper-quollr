---
title: "quollr: An R Package for Visualizing 2D Models from Nonlinear Dimension Reductions in High Dimensional Space"
abstract: >
  An abstract of less than 150 words.
draft: true
author:  
  - name: Jayani P.G. Lakshika
    affiliation: Monash University
    address: Department of Econometrics and Business Statistics, VIC 3800 Australia
    url: https://jayanilakshika.netlify.app/
    orcid: 0000-0002-6265-6481
    email:  \email{jayani.piyadigamage@monash.edu}
  - name: Dianne Cook
    affiliation: Monash University
    address: Department of Econometrics and Business Statistics, VIC 3800 Australia
    url: http://www.dicook.org/
    email: dicook@monash.edu
    orcid: 0000-0002-3813-7155
  - name: Paul Harrison
    affiliation: Monash University
    address: MGBP, BDInstitute, VIC 3800 Australia
    email: paul.harrison@monash.edu
    orcid: 0000-0002-3980-268X
  - name: Michael Lydeamore
    affiliation: Monash University
    address: Department of Econometrics and Business Statistics, VIC 3800 Australia
    email: michael.lydeamore@monash.edu
    orcid: 0000-0001-6515-827X
  - name: Thiyanga S. Talagala
    affiliation: University of Sri Jayewardenepura
    address: Department of Statistics, Gangodawila, Nugegoda 10100 Sri Lanka
    url: https://thiyanga.netlify.app/
    email: ttalagala@sjp.ac.lk
    orcid: 0000-0002-0656-9789
type: package
preamble: >
  \usepackage{amsmath}
  \usepackage{array}
output: 
  rjtools::rjournal_article:
    self_contained: yes
    toc: no
bibliography: RJreferences.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, 
                      message = FALSE)

```

```{r load-libraries}
library(quollr)
library(tibble)
library(knitr)
library(kableExtra)
library(ggplot2)

set.seed(20230531)
```

<!-- 20 pages-->

# Introduction

<!--intro with S-curve with 5 methods-->

# Methodology

<!--explain algorithm steps in summary-->

# Implementation

The package can be installed from CRAN:

```install.packages("quollr")```

The development version can be installed from GitHub:

```devtools::install_github("JayaniLakshika/quollr")```

The following demonstration of the package's functionality assumes `quollr` has been loaded. We also want to load the built-in data sets `s_curve_noise_training` and `s_curve_noise_umap`.

<!-- add about main function to gen 2D and highD models-->
## Constructing the 2D model

<!--Discuss the model can be generated with bin centroids or bin means-->

### Preprocessing
<!--Discuss scaling the NLDR data-->

The function `gen_scaled_data()` is used to prepare the NLDR data to fit within the bounds required for regular hexagonal binning, ensuring effective visualization.

<!-- add plot before and after scaling NLDR data-->

### Binning data 

<!-- add about main function for hexagonal bining-->

### Obtain bin centroids/ means

To obtain hexagonal bin centroids, `extract_hexbin_centroids()`is used. The function `extract_hexbin_mean()` is used to obtain average within each hexagon. 

### Triangulate bin centroids/ means

The `tri_bin_centroids()` is used to do triangulate bin centroids/ bin means. Then, `gen_edges()` compute the edges to obtain the triangular mesh which is the 2D model.

## Lifting the model into high dimensions

The $p$-D model is generated by `avg_highd_data()` by passing the $p$-D data. 

## Tuning model parameters

Mainly there are two model parameter need to consider: benchmark value to remove the low-density hexagons, and benchmark value to remove the long edges. `find_low_dens_hex()` is used to find the hexagons which contains less number of points by considering the density of their neighboring points as well. In here, user can first decide which are the low-density hexagons and pass them to this function to check whether these removal of low-density hexagons can affect the model fit by looking at the the neighbors. On the other hand, `find_lg_benchmark()` function is used to compute the threshold for removing long edges.

## Compute residuals and Mean Square Error (MSE)

As a Goodness of fit statistics for the model, `gen_summary()` is used to compute residuals and MSE. For the fitted model, how residuals and MSE is changing is shown in Figure 2.

<!--add a plot with total bins Vs MSE, non-empty bins Vs Error-->

## Visualizations

The package provides four basic visualizations which includes three visualizations regarding 2D model (static vis) and one is regrading $p$-D model (dynamic vis). Each visualization can be done their own functions which describes in this section.

<!--add trimesh, colored trimesh, removed edge trimesh, screenshots from langevitour with the model and data-->

### 2D model visualization

<!--2D model vis: triangular mesh, colored trimesh, removed edge trimesh-->
To visualize the 2D model, mainly three functions are used. As shown in Figure 1, `geom_trimesh()` to visualize the triangular mesh by adding a new layer to `ggplot()`. After identifying benchmark value to remove long edge, `vis_lg_mesh()` is used to visualize the triangular mesh by coloring the small and long edges. As shown in Figure 1, the small and long edges are colored by black and red respectively. Following this, `vis_rmlg_mesh()` is used to visualize smoothed 2D model which is the 2D model after removing the long edges (see Figure 1). In `vis_lg_mesh()` and `vis_rmlg_mesh()`, `benchmark_value` argument controls the edge removal in 2D.

### p-D model visualization

<!--highD model vis: langevitour with the model-->

The $p$-D model overlaid on data is visualized by the function `show_langevitour()`. This is a useful dynamic visualization result to validate visually whether the model fits the data well or not.

<!--
## Usage

-   dependencies

-   basic example-->

## Prediction

`predict_emb()` function is used to predict 2D embedding for a new data point using the fitted model. This function is useful to predict 2D embedding irrespective of the NLDR technique.

## Tests

All functions have tests written and implemented using the \CRANpkg{testthat} [@testthat] in R.

# Application

<!--select a dataset from cardinalR-->
<!-- diff shape clusters-->
<!-- talk with best fit-->

# Conclusion

# Acknowledgements

This article is created using \CRANpkg{knitr} [@knitr] and \CRANpkg{rmarkdown} [@rmarkdown] in R with the `rjtools::rjournal_article` template. The source code for reproducing this paper can be found at: <https://github.com/JayaniLakshika/paper-quollr>.
